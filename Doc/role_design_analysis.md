# Admin 和 Teacher 角色设计分析

## 当前实现

### 现状
- Admin 和 Teacher 在同一个表 `t` 中
- 通过 `role` 字段区分（'admin' 或 'teacher'）
- 登录时通过 `name === 'admin'` 判断（已改进为使用 `role` 字段）

### 优点
1. **简单统一**：所有用户在一个表中，查询和管理方便
2. **代码复用**：admin 和 teacher 可以共用大部分代码
3. **易于扩展**：如果将来需要其他角色（如辅导员），只需添加 role 值
4. **数据一致**：用户信息结构统一

### 缺点
1. **逻辑混淆**：admin 和 teacher 在业务上可能差异较大
2. **权限管理**：需要额外判断 role 字段来控制权限
3. **数据隔离**：admin 和 teacher 数据混在一起

## 方案对比

### 方案1：单表设计（当前方案，推荐）✅

**结构：**
```
表 t (teacher)
- tid (主键)
- tname (姓名)
- password (密码)
- role (角色: 'admin' 或 'teacher')
```

**优点：**
- 实现简单，代码改动小
- 查询方便，统一管理
- 易于扩展新角色
- 符合常见的设计模式

**缺点：**
- 需要始终检查 role 字段
- 如果 admin 和 teacher 字段差异很大，会有很多 NULL 值

**适用场景：**
- Admin 和 Teacher 字段基本相同
- 系统规模中等
- 需要快速实现

### 方案2：分离表设计

**结构：**
```
表 admin
- id (主键)
- username (用户名)
- password (密码)
- name (姓名)

表 teacher
- tid (主键)
- tname (姓名)
- password (密码)
- 其他教师特有字段
```

**优点：**
- 职责清晰，逻辑分离
- 可以为 admin 和 teacher 设计不同的字段
- 权限管理更直观
- 数据隔离更好

**缺点：**
- 代码重复，需要维护两套 CRUD
- 登录逻辑需要分别处理
- 如果字段相同，会造成冗余
- 扩展新角色需要新建表

**适用场景：**
- Admin 和 Teacher 字段差异很大
- 需要严格的数据隔离
- 系统规模较大
- 有专门的权限管理系统

## 推荐方案

**建议使用方案1（单表设计）**，原因：

1. **当前需求**：Admin 和 Teacher 字段基本相同（id, name, password），只有 role 不同
2. **实现成本**：方案1 已经实现，只需改进登录逻辑（已完成）
3. **维护成本**：单表设计维护更简单
4. **扩展性**：如果将来需要新角色，只需添加 role 值，无需新建表

## 已完成的改进

1. ✅ 登录逻辑已改为使用 `role` 字段判断，而不是 `name === 'admin'`
2. ✅ 权限拦截器通过请求头验证 admin 权限
3. ✅ 数据库已添加 `role` 字段

## 如果选择方案2（分离表）

**注意：** 分离表的脚本已删除，因为当前单表设计已经足够好。如果确实需要分离，需要：

1. 创建新的 admin 表结构
2. 创建 Admin 实体类、Mapper、Service、Controller
3. 修改登录逻辑，admin 和 teacher 分别登录
4. 修改权限拦截器
5. 修改前端登录页面
6. 修改所有相关的查询和操作

**工作量评估：** 约需要修改 10+ 个文件，增加 5+ 个新文件

**建议：** 除非有特殊需求，否则不建议分离，当前单表设计已经足够好。

## 总结

**当前单表设计已经足够好**，建议保持现状，只需确保：
- ✅ 使用 `role` 字段判断角色（已完成）
- ✅ 权限拦截器正确验证（已完成）
- ✅ 数据库 role 字段已添加（已完成）

如果未来 Admin 和 Teacher 的字段差异变得很大，再考虑分离。

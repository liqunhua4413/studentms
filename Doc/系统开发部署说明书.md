# 学生成绩管理系统 — 系统开发部署说明书

## 一、系统架构

### 1.1 技术栈

**后端：**
- Spring Boot 2.x
- MyBatis
- MySQL 8.0
- Apache POI (Excel处理)

**前端：**
- Vue.js 2.x
- Element UI
- Axios
- Vue Router

### 1.2 项目结构

```
studentms/
├── student_server/          # 后端项目
│   ├── src/main/java/       # Java源码
│   ├── src/main/resources/  # 配置文件
│   └── pom.xml              # Maven配置
├── student_client/          # 前端项目
│   ├── src/                 # Vue源码
│   ├── public/              # 静态资源
│   └── package.json         # NPM配置
├── mysql/                   # 数据库脚本
│   └── studentms_complete.sql
└── Doc/                     # 文档目录
```

---

## 二、环境要求

### 2.1 开发环境

- JDK 1.8+
- Maven 3.6+
- Node.js 14+
- MySQL 8.0+
- IDE：IntelliJ IDEA / Eclipse / VS Code

### 2.2 生产环境

- 服务器：Linux / Windows Server
- Java运行环境：JDK 1.8+
- Web服务器：Nginx（前端） + Tomcat（后端，可选）
- 数据库：MySQL 8.0+

---

## 三、数据库部署

### 3.1 创建数据库

```sql
CREATE DATABASE studentms DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
```

### 3.2 导入数据库脚本

```bash
mysql -u root -p studentms < mysql/studentms_complete.sql
```

### 3.3 数据库配置

修改 `student_server/src/main/resources/application.yml`：

```yaml
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/studentms?setUnicode=true&characterEncoding=utf8&useAffectedRows=true
    username: root
    password: 123456  # 修改为实际密码
```

---

## 四、后端部署

### 4.1 编译打包

```bash
cd student_server
mvn clean package -DskipTests
```

### 4.2 运行方式

#### 方式一：直接运行JAR

```bash
java -jar student_server/target/student_server.jar
```

#### 方式二：IDE运行

1. 导入项目到IDE
2. 运行 `StudentServerApplication.java`
3. 默认端口：10086

### 4.3 配置说明

**application.yml 关键配置：**

```yaml
server:
  port: 10086
  servlet:
    context-path: /api

# 文件上传配置
file:
  upload:
    path: ./uploads  # 文件上传路径，建议使用绝对路径
```

### 4.4 文件上传目录

系统会在项目根目录创建 `uploads` 文件夹用于存储上传的文件，建议：
- 使用绝对路径
- 确保目录有写入权限
- 定期清理旧文件

---

## 五、前端部署

### 5.1 安装依赖

```bash
cd student_client
npm install
```

### 5.2 开发环境运行

```bash
npm run serve
```

访问：http://localhost:8080

### 5.3 生产环境构建

```bash
npm run build
```

构建产物在 `dist/` 目录

### 5.4 前端配置

修改 `student_client/src/plugins/axios.js` 中的API地址：

```javascript
axios.defaults.baseURL = 'http://localhost:10086/api'
```

生产环境建议使用环境变量配置。

### 5.5 Nginx配置示例

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    # 前端静态文件
    location / {
        root /path/to/student_client/dist;
        try_files $uri $uri/ /index.html;
    }
    
    # 后端API代理
    location /api {
        proxy_pass http://localhost:10086/api;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## 六、功能模块说明

### 6.1 批量导入功能

所有批量导入功能均支持：
- Excel模板下载（.xlsx格式）
- 文件上传验证
- 导入结果反馈

**已实现的批量导入：**
1. 学生批量导入
2. 教师批量导入
3. 课程批量导入
4. 开课表批量导入
5. 学院批量导入
6. 专业批量导入
7. 班级批量导入
8. 成绩单批量导入（特殊格式）

### 6.2 权限控制

**后端拦截器：** `AdminInterceptor.java`
- 拦截需要管理员权限的接口
- 检查用户角色

**前端权限控制：**
- 路由守卫：检查登录状态
- 按钮权限：根据用户类型显示/隐藏

### 6.3 登录系统

**支持方式：**
- 学生：通过sid（数字）登录
- 教师/管理员：通过teacherNo（字符串，如A0001）或tid（数字）登录

**后端接口：**
- `/teacher/login` - 教师/管理员登录
- `/teacher/findByNo` - 通过teacherNo查找
- `/student/login` - 学生登录

---

## 七、API接口说明

### 7.1 模板下载接口

所有批量导入模块均提供模板下载接口：

- `/student/template` - 学生导入模板
- `/teacher/template` - 教师导入模板
- `/course/template` - 课程导入模板
- `/courseTeacher/template` - 开课表导入模板
- `/department/template` - 学院导入模板
- `/major/template` - 专业导入模板
- `/class/template` - 班级导入模板
- `/grade/template` - 成绩单导入模板

### 7.2 文件上传接口

- `/student/import` - 学生批量导入
- `/teacher/import` - 教师批量导入
- `/course/import` - 课程批量导入
- `/courseTeacher/import` - 开课表批量导入
- `/department/import` - 学院批量导入
- `/major/import` - 专业批量导入
- `/class/import` - 班级批量导入
- `/grade/upload` - 成绩单上传
- `/paper/upload` - 试卷分析上传

---

## 八、常见问题排查

### 8.1 后端启动失败

**问题：** 端口被占用
```bash
# Windows
netstat -ano | findstr :10086
taskkill /PID <PID> /F

# Linux
lsof -i :10086
kill -9 <PID>
```

**问题：** 数据库连接失败
- 检查MySQL服务是否启动
- 检查数据库配置是否正确
- 检查数据库用户权限

### 8.2 前端编译错误

**问题：** 依赖安装失败
```bash
# 清除缓存
npm cache clean --force
# 删除node_modules重新安装
rm -rf node_modules
npm install
```

### 8.3 文件上传失败

**问题：** 500错误
- 检查上传目录权限
- 检查文件大小限制（默认50MB）
- 查看后端日志

### 8.4 跨域问题

后端已配置 `@CrossOrigin("*")`，如仍有问题：
- 检查前端axios配置
- 检查Nginx代理配置

---

## 九、性能优化建议

### 9.1 数据库优化

- 为常用查询字段添加索引
- 定期清理历史数据
- 使用连接池

### 9.2 文件存储优化

- 使用对象存储服务（OSS）
- 定期清理临时文件
- 限制文件大小

### 9.3 前端优化

- 启用Gzip压缩
- 使用CDN加速静态资源
- 代码分割和懒加载

---

## 十、安全建议

### 10.1 密码安全

- 使用强密码策略
- 密码加密存储（BCrypt）
- 定期更换密码

### 10.2 接口安全

- 添加JWT Token认证
- 限制接口访问频率
- 验证用户权限

### 10.3 数据安全

- 定期备份数据库
- 敏感数据加密
- 日志审计

---

## 十一、维护与更新

### 11.1 日志查看

后端日志位置：控制台输出或配置的日志文件

### 11.2 数据备份

```bash
# 备份数据库
mysqldump -u root -p studentms > backup_$(date +%Y%m%d).sql

# 恢复数据库
mysql -u root -p studentms < backup_20240101.sql
```

### 11.3 版本更新

1. 备份数据库和代码
2. 更新代码
3. 执行数据库迁移脚本（如有）
4. 重启服务
5. 验证功能

---

## 十二、联系方式

- 开发者：liqunhua
- 单位：邯郸应用技术职业学院
- QQ：2361271255
- 项目地址：https://github.com/liqunhua4413/studentms

---

## 附录：环境变量配置

### 后端环境变量

```bash
# 数据库配置
DB_HOST=localhost
DB_PORT=3306
DB_NAME=studentms
DB_USER=root
DB_PASSWORD=your_password

# 文件上传路径
UPLOAD_PATH=/data/uploads
```

### 前端环境变量

创建 `.env.production`：

```
VUE_APP_API_BASE_URL=http://your-api-domain.com/api
```
